# 华中科技大学网络空间安全学院汇编语言程序设计考试题目

**说明**：本考试题目涵盖汇编语言程序设计的核心概念，包括顺序程序设计、分支程序设计、循环程序设计和子程序设计。总分120分，考试时间150分钟。

---

# 一、顺序程序设计分析题（共25分）

## 1. 阅读以下程序段，回答相关问题（15分 = 4+4+3+4）

```
 1 .MODEL SMALL
 2 .STACK 100H
 3
 4 .DATA
 5     NUM DW 100
 6     SUM DW 0, 0
 7
 8 .CODE
 9 .STARTUP
10     MOV AX, NUM
11     INC AX
12     MOV BX, NUM
13     MUL BX
14     SHR DX, 1
15     RCR AX, 1
16     MOV WORD PTR SUM+2, DX
17     MOV WORD PTR SUM, AX
18 .EXIT 0
19 END
```

**(1) 该程序实现了什么数学公式？请详细解释其算法原理。（4分）**

**(2) 第13行MUL BX指令执行后，DX和AX的值分别是多少？请说明计算过程。（4分）**

**(3) 第14-15行使用SHR和RCR指令组合，为什么不能用SHR AX, 1单独处理？（3分）**

**(4) 如果NUM的值为300，程序执行后SUM变量存储的结果是什么？请用十六进制表示。（4分）**

## 2. 阅读以下程序段，回答相关问题（10分 = 3+3+4）

```
 1 .MODEL SMALL
 2 .STACK 100H
 3
 4 .DATA
 5     STRING DB 'Hello WORLD! This Is A Test0'
 6     MSG_BEFORE DB 'String before processing: Hello WORLD! This Is A Test', 13, 10, '$'
 7     MSG_AFTER_TITLE DB 13, 10, 'String after processing: ', '$'
 8
 9 .CODE
10 .STARTUP
11     LEA DX, MSG_BEFORE
12     MOV AH, 09H
13     INT 21H
14     MOV SI, OFFSET STRING
15 loop_start:
16     MOV AL, [SI]
17     CMP AL, '0'
18     JE loop_end
19     CMP AL, 'A'
20     JB next_char
21     CMP AL, 'Z'
22     JA next_char
23     ADD AL, 32
24     MOV [SI], AL
25 next_char:
26     INC SI
27     JMP loop_start
28 loop_end:
29     MOV SI, OFFSET STRING
30 find_end:
31     MOV AL, [SI]
32     CMP AL, '0'
33     JE replace_end
34     INC SI
35     JMP find_end
36 replace_end:
37     MOV BYTE PTR [SI], '$'
38     LEA DX, MSG_AFTER_TITLE
39     MOV AH, 09H
40     INT 21H
41     LEA DX, STRING
42     MOV AH, 09H
43     INT 21H
44 .EXIT 0
45 END
```

**(1) 该程序完成了什么字符串处理功能？处理后的字符串内容是什么？（3分）**

**(2) 第19-22行的大写字母判断逻辑是否存在漏洞？如果字符串中包含字符'['，会发生什么？（3分）**

**(3) 程序包含两个循环，分析它们的作用和区别。如果要将两个循环合并优化，应该如何修改？（4分）**

---

# 二、分支程序设计分析题（共30分）

## 1. 阅读以下程序段，回答相关问题（15分 = 4+4+3+4）

```
 1 .MODEL SMALL
 2 .STACK 100H
 3
 4 .DATA
 5     RESULT DW ?
 6     OVERFLOW DB 0
 7
 8 .CODE
 9 .STARTUP
10     MOV AX, 8000H
11     MOV BX, 0001H
12     ADD AX, BX
13     JO overflow_check
14     JNS positive_check
15     MOV RESULT, AX
16     JMP finish
17 overflow_check:
18     MOV OVERFLOW, 1
19     JC positive_check
20     NEG AX
21     MOV RESULT, AX
22     JMP finish
23 positive_check:
24     CMP AX, 0
25     JGE zero_check
26     NEG AX
27 zero_check:
28     MOV RESULT, AX
29 finish:
30     CMP OVERFLOW, 1
31     JNE exit_program
32     MOV RESULT, 0FFFFH
33 exit_program:
34     .EXIT 0
35 END
```

**(1) 分析该程序的复杂分支逻辑，说明它处理了哪些异常情况。（4分）**

**(2) 第12行ADD指令执行后，各个标志位（OF、SF、CF、ZF）的状态分别是什么？（4分）**

**(3) 程序执行完后，RESULT和OVERFLOW变量的值分别是什么？（3分）**

**(4) 如果将第10行改为`MOV AX, 7FFFH`，程序的执行路径会有什么不同？请详细分析。（4分）**

## 2. 阅读以下程序段，回答相关问题（15分 = 4+4+3+4）

```
 1 .MODEL SMALL
 2 .STACK 100H
 3
 4 .DATA
 5     GRADE DW 85
 6     RESULT DB ?
 7
 8 .CODE
 9 .STARTUP
10     MOV AX, GRADE
11     CMP AX, 90
12     JAE grade_a
13     CMP AX, 80
14     JAE grade_b
15     CMP AX, 70
16     JAE grade_c
17     CMP AX, 60
18     JAE grade_d
19     MOV RESULT, 'F'
20     JMP done
21 grade_a:
22     MOV RESULT, 'A'
23     JMP done
24 grade_b:
25     MOV RESULT, 'B'
26     JMP done
27 grade_c:
28     MOV RESULT, 'C'
29     JMP done
30 grade_d:
31     MOV RESULT, 'D'
32 done:
33     .EXIT 0
34 END
```

**(1) 该程序实现了什么功能？对于输入值85，输出结果是什么？（4分）**

**(2) 这种多重分支结构效率较低，请使用跳转表（Jump Table）方法优化该程序，写出优化后的核心代码。（4分）**

**(3) 如果要在程序中增加对负数分数的处理（小于0分显示'E'），应该如何修改？（3分）**

**(4) 分析第11-17行连续比较指令的执行效率问题，并提出改进建议。（4分）**

---

# 三、循环程序设计分析题（共30分）

## 1. 阅读以下程序段，回答相关问题（18分 = 4+5+4+3+2）

```
 1 .MODEL SMALL
 2 .STACK 100H
 3
 4 .DATA
 5     ARRAY   DB 92, 55, 30, 78, 41, 88, 12, 67
 6     COUNT   EQU 8
 7     SWAPPED DB 0
 8
 9 .CODE
10 .STARTUP
11     MOV CX, COUNT-1
12 OuterLoop:
13     MOV SWAPPED, 0
14     PUSH CX
15     MOV SI, OFFSET ARRAY
16     MOV DL, COUNT-1
17 InnerLoop:
18     MOV AL, [SI]
19     MOV BL, [SI+1]
20     CMP AL, BL
21     JBE NoSwap
22     MOV [SI], BL
23     MOV [SI+1], AL
24     MOV SWAPPED, 1
25 NoSwap:
26     INC SI
27     DEC DL
28     JNZ InnerLoop
29     POP CX
30     CMP SWAPPED, 0
31     JE SortDone
32     LOOP OuterLoop
33 SortDone:
34 .EXIT 0
35 END
```

**(1) 该程序与标准冒泡排序相比有什么优化？SWAPPED变量的作用是什么？（4分）**

**(2) 详细分析第14行`PUSH CX`和第29行`POP CX`的必要性。如果去掉这两条指令，在什么情况下程序会出现错误？（5分）**

**(3) 第27行使用`DEC DL`和`JNZ`控制内循环，而外循环使用`LOOP`指令，为什么要使用不同的循环控制方式？（4分）**

**(4) 如果数组已经是升序排列，程序会如何执行？请分析执行路径和效率。（3分）**

**(5) 程序第11行`MOV CX, COUNT-1`中为什么要减1？如果改为`MOV CX, COUNT`会发生什么？（2分）**

## 2. 阅读以下程序段，回答相关问题（12分 = 4+4+4）

```
 1 .MODEL SMALL
 2 .STACK 100H
 3
 4 .DATA
 5     TEXT    DB 'This is a sample text for searching pattern'
 6     PATTERN DB 'search'
 7     TEXTLEN EQU $-TEXT-1
 8     PATLEN  EQU 6
 9     FOUND   DW -1
10
11 .CODE
12 .STARTUP
13     MOV CX, TEXTLEN
14     SUB CX, PATLEN
15     JS NotFound
16     MOV SI, OFFSET TEXT
17 OuterSearch:
18     PUSH SI
19     PUSH CX
20     MOV DI, OFFSET PATTERN
21     MOV BX, PATLEN
22 InnerCompare:
23     MOV AL, [SI]
24     CMP AL, [DI]
25     JNE Mismatch
26     INC SI
27     INC DI
28     DEC BX
29     JNZ InnerCompare
30     POP CX
31     POP AX
32     MOV AX, TEXTLEN
33     SUB AX, CX
34     MOV FOUND, AX
35     JMP Done
36 Mismatch:
37     POP CX
38     POP SI
39     INC SI
40     LOOP OuterSearch
41 NotFound:
42     MOV FOUND, -1
43 Done:
44 .EXIT 0
45 END
```

**(1) 该程序实现了什么字符串搜索算法？其时间复杂度是多少？（4分）**

**(2) 分析第14行`SUB CX, PATLEN`和第15行`JS NotFound`的作用。为什么要提前计算这个值？（4分）**

**(3) 第30-33行的寄存器保护操作（PUSH/POP）有什么特别之处？为什么使用了`POP AX`而不是`POP SI`？（4分）**

---

# 四、子程序设计分析题（共35分）

## 1. 阅读以下程序段，回答相关问题（20分 = 5+5+4+3+3）

```
 1 .MODEL SMALL
 2 .STACK 100H
 3
 4 .DATA
 5     NUMBER  DW 5
 6     RESULT  DW ?
 7
 8 .CODE
 9 .STARTUP
10     MOV AX, NUMBER
11     PUSH AX
12     CALL FACTORIAL
13     MOV RESULT, AX
14 .EXIT 0
15
16 FACTORIAL PROC NEAR
17     PUSH BP
18     MOV BP, SP
19     PUSH BX
20
21     MOV AX, [BP+4]
22     CMP AX, 1
23     JLE BaseCase
24
25     DEC AX
26     PUSH AX
27     CALL FACTORIAL
28     MOV BX, AX
29
30     MOV AX, [BP+4]
31     MUL BX
32     JMP Return
33
34 BaseCase:
35     MOV AX, 1
36 Return:
37     POP BX
38     POP BP
39     RET 2
40 FACTORIAL ENDP
41 END
```

**(1) 分析该程序的递归调用过程，画出NUMBER=5时的完整调用栈变化过程。（5分）**

**(2) 第39行`RET 2`指令的作用是什么？与普通`RET`指令有什么区别？（5分）**

**(3) 程序执行后，RESULT变量的值是多少？如果NUMBER=6，结果又是什么？（4分）**

**(4) 第17行`PUSH BP`和第18行`MOV BP, SP`的作用是什么？为什么需要建立栈帧？（3分）**

**(5) 如果要在程序中增加对负数的处理（返回0），应该如何修改递归函数？（3分）**

## 2. 阅读以下程序段，回答相关问题（15分 = 4+4+3+4）

```
 1 .MODEL SMALL
 2 .STACK 100H
 3
 4 .DATA
 5     BUFFER  DB 10 DUP(?)
 6     COUNT   DB 0
 7     HEX_NUM DB 0AFH
 8
 9 .CODE
10 .STARTUP
11     MOV AL, HEX_NUM
12     LEA SI, BUFFER
13     CALL HEX_TO_BIN_STR
14     MOV COUNT, AL
15 .EXIT 0
16
17 HEX_TO_BIN_STR PROC NEAR
18     PUSH AX
19     PUSH CX
20     PUSH SI
21     PUSH DX
22
23     MOV CX, 8
24     MOV DL, 0
25
26 ConvertLoop:
27     SHL AL, 1
28     JC BitIsOne
29     MOV BYTE PTR [SI], '0'
30     JMP NextBit
31 BitIsOne:
32     MOV BYTE PTR [SI], '1'
33 NextBit:
34     INC SI
35     INC DL
36     LOOP ConvertLoop
37
38     MOV BYTE PTR [SI], '$'
39     MOV AL, DL
40
41     POP DX
42     POP SI
43     POP CX
44     POP AX
45     RET
46 HEX_TO_BIN_STR ENDP
47 END
```

**(1) 该程序实现了什么功能？HEX_NUM = 0AFH时，BUFFER中的内容是什么？（4分）**

**(2) 第27行`SHL AL, 1`指令的作用是什么？为什么选择左移而不是右移？（4分）**

**(3) 分析第38行`MOV BYTE PTR [SI], '$'`的作用。如果去掉这行代码，调用方程序会发生什么问题？（3分）**

**(4) 如果要求修改程序，使其将十六进制数转换为十进制字符串，应该如何修改算法？请简要描述设计思路和需要添加的子程序。（4分）**

---

# 五、综合应用和陷阱分析题（共20分）

## 1. 阅读以下程序段，回答相关问题（10分 = 3+3+4）

```
 1 .MODEL SMALL
 2 .STACK 100H
 3
 4 .DATA
 5     DATA1   DB 12H, 34H
 6     DATA2   DW 5678H
 7     DATA3   DB 9AH
 8     DATA4   DD 0B1234567H
 9
10 .CODE
11 .STARTUP
12     MOV AX, WORD PTR DATA1+1
13     MOV BX, DATA2
14     MOV CX, WORD PTR DATA3
15     MOV DX, WORD PTR DATA4
16     MOV SI, WORD PTR DATA4+2
17
18     MOV AX, WORD PTR DATA4
19     MOV BX, WORD PTR DATA4+2
20 .EXIT 0
21 END
```

**(1) 分析第12-16行指令中存在的内存访问问题。哪些指令存在陷阱？（3分）**

**(2) DATA3变量定义为字节，但第14行按字访问，这在什么情况下会导致问题？（3分）**

**(3) 如果要在小端序（Little Endian）系统上正确读取DATA4的双字数据，应该如何修改代码？（4分）**

## 2. 阅读以下程序段，回答相关问题（10分 = 4+6）

```
 1 .MODEL SMALL
 2 .STACK 100H
 3
 4 .CODE
 5 .STARTUP
 6     MOV AL, 7FH
 7     ADD AL, 1
 8
 9     JO overflow1
10     JNS positive1
11     JS negative1
12
13 overflow1:
14     SUB AL, 1
15     JC carry1
16     JZ zero1
17
18 carry1:
19     CMP AL, 7FH
20     JE equal1
21     JG greater1
22     JL less1
23
24 equal1:
25     NEG AL
26     JS negative2
27     JO overflow2
28
29 negative2:
30 .EXIT 0
31 END
```

**(1) 详细分析程序中每条指令执行后的标志位变化，并标出实际执行的跳转路径。（4分）**

**(2) 程序最后执行到EXIT时，AL寄存器的值是多少？请写出完整的执行流程分析。（6分）**

---

**考试说明**：
- 总分120分，建议答题时间150分钟
- 请在答题卡上作答，字迹清晰
- 涉及计算的请写出详细过程
- 程序分析题请说明 reasoning