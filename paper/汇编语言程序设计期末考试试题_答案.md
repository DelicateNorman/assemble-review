# 汇编语言程序设计期末考试试题（一）- 标准答案

**考试时间：** 120分钟
**总分：** 100分

---

## 一、单选题（10道题，每题2分，共20分）

1. **(D)** IP（指令指针寄存器）不能用LEA指令加载，因为IP是专用寄存器。
2. **(C)** IP（指令指针寄存器）用于存放下一条要执行指令的偏移地址。
3. **(B)** [BX+SI+6]是基址变址相对寻址方式，默认段地址在DS段，物理地址 = DS×16 + BX + SI + 6。
4. **(C)** [BP]寻址方式默认在SS段（堆栈段）。
5. **(B)** .DATA伪指令用于定义数据段。
6. **(D)** AX=8000H（最高位为1），左移一位后AX=0000H，CF=1（移出的位），OF=1（符号位改变）。
7. **(C)** MOV指令是数据传送指令，不影响任何标志位。
8. **(C)** JMP是无条件转移指令。
9. **(D)** PUSH指令先将SP减2，然后将数据压入堆栈。
10. **(A)** CALL指令将返回地址压入堆栈，RET指令从堆栈弹出返回地址。

---

## 二、填空题（10个，每空2分，共20分）

1. AH，AL
2. 段地址，偏移地址
3. 进位，零
4. 堆栈，代码
5. 1234，1
6. ES:[DI]，增加（SI±1，DI±1）
7. 寄存器，堆栈
8. DOS，程序
9. 控制，分支
10. .obj，.exe

---

## 三、指令正确与错误判断题（5条指令，每条2分，共10分）

1. `MOV CS, AX`
   - 判断：**错误**
   - 错误原因：CS是代码段寄存器，不能作为目的操作数，不能直接用MOV指令修改CS的值。

2. `ADD [SI], [DI]`
   - 判断：**错误**
   - 错误原因：两个操作数都是存储器操作数，8086指令系统不允许两个存储器操作数直接进行运算。

3. `PUSH AL`
   - 判断：**错误**
   - 错误原因：PUSH指令的操作数必须是16位（字），而AL是8位寄存器。

4. `JMP BX`
   - 判断：**错误**
   - 错误原因：寄存器间接寻址跳转指令必须使用字操作数，应为JMP WORD PTR [BX]或JMP BX（在某些情况下正确，但严格来说应该是JMP WORD PTR [BX]）。

5. `MOV DS, 1000H`
   - 判断：**错误**
   - 错误原因：不能直接将立即数传送到段寄存器，需要通过通用寄存器中转，如：
   ```
   MOV AX, 1000H
   MOV DS, AX
   ```

---

## 四、简答题（2题，每题8分，共16分）

### 1. 请简述8086CPU的寄存器分类，并说明各类寄存器的主要功能。

**答案：**

8086CPU的寄存器分为以下四类：

**（1）通用寄存器（8个）：**
- AX、BX、CX、DX：数据寄存器，用于算术运算、逻辑运算和数据传送
  - AX：累加器，使用频度最高
  - BX：基址寄存器，常用作地址寄存器
  - CX：计数器，常用于循环计数
  - DX：数据寄存器，常用于双字运算的高16位
- SI、DI：变址寄存器，用于字符串操作和地址计算
- BP、SP：指针寄存器
  - BP：基址指针，用于堆栈段中的数据访问
  - SP：堆栈指针，指向堆栈栈顶

**（2）段寄存器（4个）：**
- CS：代码段寄存器，存放代码段的段地址
- DS：数据段寄存器，存放数据段的段地址
- SS：堆栈段寄存器，存放堆栈段的段地址
- ES：附加段寄存器，存放附加段的段地址

**（3）控制寄存器（2个）：**
- IP：指令指针寄存器，指向下一条要执行的指令
- FLAGS：标志寄存器，反映CPU的状态和控制信息

**（4）各寄存器还可按8位访问：**
- AH、AL、BH、BL、CH、CL、DH、DL

### 2. 请简述汇编语言程序的开发过程，包括编辑、汇编、连接和调试各个阶段的主要任务。

**答案：**

汇编语言程序的开发过程包括以下四个阶段：

**（1）编辑阶段：**
- **任务**：使用文本编辑器编写汇编语言源程序（.asm文件）
- **要求**：严格按照汇编语言的语法格式编写，包括正确的指令、伪指令、注释等
- **工具**：可以使用任何纯文本编辑器，如EDIT、记事本等

**（2）汇编阶段：**
- **任务**：使用汇编程序（MASM）将源程序翻译成目标代码（.obj文件）
- **过程**：汇编程序检查语法错误，将助记符转换为机器码，生成目标模块
- **命令**：`MASM 文件名.ASM;`
- **结果**：生成目标文件（.obj），如有语法错误则显示错误信息

**（3）连接阶段：**
- **任务**：使用连接程序（LINK）将一个或多个目标文件连接成可执行文件（.exe文件）
- **过程**：解决符号引用，分配内存地址，生成可执行程序
- **命令**：`LINK 文件名.OBJ;`
- **结果**：生成可执行文件（.exe）

**（4）调试阶段：**
- **任务**：运行和测试程序，发现并修正错误
- **工具**：可以使用DEBUG等调试程序进行单步执行、查看寄存器和内存内容
- **过程**：设置断点、单步执行、检查程序状态、修正逻辑错误

**整个开发流程是：编辑 → 汇编 → 连接 → 调试，如果发现错误则返回编辑阶段重新开始。**

---

## 五、程序阅读题（4段代码，每题5分，共20分）

### 1. 数据传送程序

**填空答案：**
- lea si, source
- lea di, dest
- mov cx, 12
- rep movsb

**代码段作用：**
该程序段实现字符串传送功能，将源字符串"Hello World"从source缓冲区传送到dest缓冲区，然后显示传送后的字符串。

### 2. 数组求和程序

**填空答案：**
- mov cx, count
- lea bx, array
- add ax, [bx]
- mov sum, ax

**代码段作用：**
该程序段计算数组array中所有元素的总和，将结果保存在sum变量中。数组包含5个元素：10, 20, 30, 40, 50，最终sum=150。

### 3. 字符转换程序

**填空答案：**
- mov al, char
- add al, 32
- mov result, al

**代码段作用：**
该程序段实现字符大小写转换功能，如果字符是大写字母（'A'-'Z'），则转换为对应的小写字母，其他字符保持不变。

### 4. 分支判断程序

**填空答案：**
- mov ax, num
- cmp
- mov ah, 9

**代码段作用：**
该程序段判断数值的正负性，如果num≥0则显示"Positive"，如果num<0则显示"Negative"。

---

## 六、程序设计题（14分）

**参考答案：**

```assembly
; 程序功能：从键盘输入5个有符号十进制数，找出最大值和最小值并显示
.model small
.stack 100h
.data
    max_num   equ 5
    numbers   dw max_num dup(?)
    max_val   dw ?
    min_val   dw ?
    msg_input db '请输入第$'
    msg_num   db '个有符号数: $'
    msg_max   db 0dh,0ah,'最大值: $'
    msg_min   db 0dh,0ah,'最小值: $'
    count     dw 0

.code
startup
    mov ax, @data
    mov ds, ax

    ; 输入5个有符号数
    mov cx, max_num
    mov si, 0
    mov count, 1

input_loop:
    push cx
    push si

    ; 显示输入提示
    mov dx, offset msg_input
    mov ah, 9
    int 21h

    mov ax, count
    call display_decimal
    mov dx, offset msg_num
    mov ah, 9
    int 21h

    ; 调用输入子程序
    call read_signed_decimal
    mov numbers[si], ax

    pop si
    pop cx

    add si, 2
    inc count
    loop input_loop

    ; 初始化最大值和最小值
    mov ax, numbers[0]
    mov max_val, ax
    mov min_val, ax

    ; 查找最大值和最小值
    mov cx, max_num-1
    mov si, 2

find_loop:
    mov ax, numbers[si]

    ; 比较最大值
    cmp ax, max_val
    jle not_max
    mov max_val, ax

not_max:
    ; 比较最小值
    cmp ax, min_val
    jge not_min
    mov min_val, ax

not_min:
    add si, 2
    loop find_loop

    ; 显示结果
    mov dx, offset msg_max
    mov ah, 9
    int 21h
    mov ax, max_val
    call display_signed_decimal

    mov dx, offset msg_min
    mov ah, 9
    int 21h
    mov ax, min_val
    call display_signed_decimal

    exit 0

; 输入有符号十进制数子程序
; 输入：无
; 输出：AX = 有符号数值
read_signed_decimal proc
    push bx
    push cx
    push dx

    xor bx, bx        ; 结果
    mov cx, 0         ; 符号标志，0为正，-1为负

    ; 读第一个字符
    mov ah, 1
    int 21h

    ; 处理符号
    cmp al, '+'
    je read_next
    cmp al, '-'
    jne convert_digit
    mov cx, -1        ; 负数标志

read_next:
    mov ah, 1
    int 21h

convert_loop:
    cmp al, '0'
    jb done_input
    cmp al, '9'
    ja done_input

convert_digit:
    sub al, '0'
    mov ah, 0
    push ax

    ; 结果乘以10
    mov ax, bx
    mov dx, 10
    mul dx
    mov bx, ax

    pop ax
    add bx, ax

    mov ah, 1
    int 21h
    jmp convert_loop

done_input:
    mov ax, bx
    cmp cx, 0
    je positive_result
    neg ax

positive_result:
    pop dx
    pop cx
    pop bx
    ret
read_signed_decimal endp

; 显示有符号十进制数子程序
; 输入：AX = 有符号数值
; 输出：屏幕显示
display_signed_decimal proc
    push ax
    push bx
    push cx
    push dx

    test ax, ax
    jns display_positive

    ; 显示负号
    push ax
    mov dl, '-'
    mov ah, 2
    int 21h
    pop ax
    neg ax

display_positive:
    call display_decimal

    pop dx
    pop cx
    pop bx
    pop ax
    ret
display_signed_decimal endp

; 显示无符号十进制数子程序
; 输入：AX = 无符号数值
; 输出：屏幕显示
display_decimal proc
    push ax
    push bx
    push cx
    push dx

    xor cx, cx        ; 计数器
    mov bx, 10        ; 除数

divide_loop:
    xor dx, dx
    div bx
    push dx          ; 余数压栈
    inc cx
    test ax, ax
    jnz divide_loop

display_loop:
    pop dx
    add dl, '0'
    mov ah, 2
    int 21h
    loop display_loop

    pop dx
    pop cx
    pop bx
    pop ax
    ret
display_decimal endp

end
```

**评分标准：**
- 程序结构完整（简化段定义格式）：2分
- 数据输入功能正确：3分
- 最大值最小值查找逻辑正确：4分
- 结果显示功能正确：3分
- 子程序设计和调用正确：2分

---

**总分：100分**