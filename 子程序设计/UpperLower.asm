;4.28 大小写转换子程序
;题目要求
;编写一个子程序，根据入口参数AL为0、1、2，分别实现大写字母转换成小写字母、
;小写字母转换成大写字母或大小写字母互换。欲转换的字符串在string中，用0表示结束。
.MODEL SMALL
.STACK 100H
.DATA
    STRING DB 'HELLO,WORLD',0
.CODE
.STARTUP
    MOV AL,1 ;在这里填入0或者1或者2
    CALL CONVERT_STRING
.EXIT 0

CONVERT_STRING PROC
CMP AL,0
JNZ NOT_ZERO
CALL UpperToLower
NOT_ZERO:
CMP AL,1
JNZ NOT_ONE
CALL LowerToUpper
NOT_ONE:
CMP AL,2
JNZ DONE
CALL UNIFIED
DONE:
RET
CONVERT_STRING ENDP

UpperToLower PROC
PUSH BX
PUSH SI
MOV SI,OFFSET STRING
MOV BL,20H
CMP [SI],0
JZ NO_EXECUTE
AGAIN:
CMP [SI],41H
JB OUT1
CMP [SI],5AH
JA OUT1
ADD [SI],BL
OUT1:
INC SI
CMP [SI],0
JNZ AGAIN
NO_EXECUTE:
POP SI
POP BX
RET
UpperToLower ENDP


LowerToUpper PROC
PUSH BX
PUSH SI
MOV SI,OFFSET STRING
MOV BL,20H
CMP [SI],0
JZ NO_EXECUTE2
AGAIN2:
CMP [SI],61H
JB OUT2
CMP [SI],7AH
JA OUT2
SUB [SI],BL
OUT2:
INC SI
CMP [SI],0
JNZ AGAIN2
NO_EXECUTE2:
POP SI
POP BX
RET
LowerToUpper ENDP


UNIFIED PROC
PUSH BX
PUSH SI
MOV SI,OFFSET STRING
MOV BL,20H
CMP [SI],0
JZ NO_EXECUTE3
AGAIN3:
; 先判小写 a..z
CMP [SI],61H
JB CHECK_UPPER3
CMP [SI],7AH
JA CHECK_UPPER3
SUB [SI],BL
JMP OUT3
CHECK_UPPER3:
; 再判大写 A..Z
CMP [SI],41H
JB OUT3
CMP [SI],5AH
JA OUT3
ADD [SI],BL
OUT3:
INC SI
CMP [SI],0
JNZ AGAIN3
NO_EXECUTE3:
POP SI
POP BX
RET
UNIFIED ENDP

END
